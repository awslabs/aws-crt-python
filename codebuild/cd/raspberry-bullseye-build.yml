version: 0.2
#this build spec assumes the manylinux1 image for pypi
#additional packages we installed: cmake 3.5, libcrypto 1.1.0j, gcc 4.8.4
phases:
  install:
    commands:
  pre_build:
    commands:
      - export CC=gcc
      - cd aws-crt-python
      - python3 ./continuous-delivery/update-version.py
  build:
    commands:
      - echo Build started on `date`
      - python3.6 setup.py sdist bdist_wheel
      - python3.7 setup.py sdist bdist_wheel
      - python3.8 setup.py sdist bdist_wheel
      - python3.9 setup.py sdist bdist_wheel
      - python3.10 setup.py sdist bdist_wheel
      # python 3.9 is the last version manylinux1 will ever receive
      - cp -r wheelhouse ../dist
  post_build:
    commands:
      - echo Build completed on `date`

artifacts:
  files:
    - 'dist/*'
